import{d as e,s as a,a1 as t,B as n,v as l,f as i,a2 as s,C as o,a3 as r,o as c,g as d,V as u,H as v,w as p,a4 as h,a as f,n as g,j as y,W as m,$ as x,a0 as w,a5 as _,c as k,h as b,a7 as I,F as S,a8 as C,G as O,a9 as T,aa as N,Q as P,ab as L,K as H,ad as J,ae as E,ac as A,af as j}from"./index-37a7a205.js";import{g as z,h as B,j as R,m as U,E as M,k as D,f as W,l as $,n as K,v as V,H as q}from"./index-559d178e.js";const F=e=>(J("data-v-d7ff820b"),e=e(),E(),e),Q={class:"aichat-main"},X={class:"chat-class"},Y={class:"feed-out"},G={class:"model-pick"},Z={key:0,class:"human"},ee={class:"h-content"},ae={class:"h-inner"},te={key:0,class:"h-c1"},ne={class:"c2"},le={key:1,class:"h-c1-all"},ie={class:"h-c3-out"},se={class:"h-c3-edit"},oe=F((()=>u("svg",{class:"icon4","aria-hidden":"true"},[u("use",{"xlink:href":"#icon-duihao2"})],-1))),re=F((()=>u("svg",{class:"icon5","aria-hidden":"true"},[u("use",{"xlink:href":"#icon-ruocuowu"})],-1))),ce={class:"user"},de={key:1,class:"ai"},ue={class:"ai-inner"},ve={class:"user"},pe={class:"ai-c1"},he={key:0,class:"ai-title"},fe={key:1,class:"warn-icon"},ge=[F((()=>u("svg",{class:"icon2","aria-hidden":"true"},[u("use",{"xlink:href":"#icon-jinggao3"})],-1)))],ye=["innerHTML"],me={key:2,class:"start-prompt"},xe={class:"ai-c3-out"},we={key:0,class:"ai-c3"},_e={class:"ai-c3-btn"},ke=F((()=>u("svg",{class:"icon3","aria-hidden":"true"},[u("use",{"xlink:href":"#icon-fuzhi2"})],-1))),be=F((()=>u("div",{class:"empty"},null,-1))),Ie=F((()=>u("svg",{class:"icon5","aria-hidden":"true"},[u("use",{"xlink:href":"#icon-xiangxia31"})],-1))),Se={class:"bottom-item",id:"inputArea"},Ce=F((()=>u("div",{class:"file-position"},null,-1))),Oe={class:"input-position"},Te={key:0,class:"ipt"},Ne=[F((()=>u("svg",{class:"icon8","aria-hidden":"true"},[u("use",{"xlink:href":"#icon-fasong"})],-1)))],Pe=[F((()=>u("svg",{class:"icon8","aria-hidden":"true"},[u("use",{"xlink:href":"#icon-fasong1"})],-1)))],Le=[A('<svg version="1.1" id="L6" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve" data-v-d7ff820b><rect fill="none" stroke="#fff" stroke-width="4" x="25" y="25" width="50" height="50" data-v-d7ff820b><animateTransform attributeName="transform" dur="0.5s" from="0 50 50" to="180 50 50" type="rotate" id="strokeBox" attributeType="XML" begin="rectBox.end" data-v-d7ff820b></animateTransform></rect><rect x="27" y="27" fill="#fff" width="46" height="50" data-v-d7ff820b><animate attributeName="height" dur="1.3s" attributeType="XML" from="50" to="0" id="rectBox" fill="freeze" begin="0s;strokeBox.end" data-v-d7ff820b></animate></rect></svg>',1)],He=F((()=>u("div",null,null,-1))),Je={key:1,class:"resend"},Ee=F((()=>u("span",{class:"resend-text"},"重新生成",-1))),Ae=F((()=>u("svg",{class:"icon3","aria-hidden":"true"},[u("use",{"xlink:href":"#icon-zhongxinshengcheng4"})],-1))),je={key:2,class:"resend"},ze=F((()=>u("span",{class:"resend-text"},"重新发送",-1))),Be=F((()=>u("svg",{class:"icon3","aria-hidden":"true"},[u("use",{"xlink:href":"#icon-zhongxinshengcheng4"})],-1))),Re="服务器返回出错，请重新生成！",Ue=j(e({__name:"llm",emits:["update-data"],setup(e,{emit:J}){const E=T((()=>N((()=>import("./ApiSet-644a7437.js")),["./ApiSet-644a7437.js","./index-37a7a205.js","../css/index-03bb3caf.css","./index-559d178e.js","../css/index-3fdf9714.css","../css/ApiSet-f23c22f6.css"],import.meta.url))),A=a(!1),j=a(),F=function(){A.value=!A.value},Ue=function(){A.value=!1},Me=z(),{llmParam:De,apiBaseUrl:We,modelSelect:$e,authHeader:Ke,systemSetup:Ve,modelName:qe}=t(Me);n(We,(e=>{}));const Fe=function(e){Me.seyLlmParams(e)},Qe=a(0);l({40:{style:{color:"#1989FA"},label:"80(推荐)"}}),l({80:{style:{color:"#1989FA"},label:"0.8(推荐)"}}),l({40:{style:{color:"#1989FA"},label:"0.8(推荐)"}});const Xe=a(40),Ye=a(80),Ge=a(40),Ze=a(40),ea=a(80),aa=a(40),ta=a(!1),na=a(),la=i((()=>window.innerWidth<=1440?{width:ta.value?"260px":"130px",height:ta.value?"168px":"32px",marginLeft:ta.value?"-65px":"0px"}:window.innerWidth>1440&&window.innerWidth<=1920?{width:ta.value?"320px":"160px",height:ta.value?"168px":"36px",marginLeft:ta.value?"-80px":"0px"}:{width:ta.value?"400px":"200px",height:ta.value?"168px":"42px",marginLeft:ta.value?"-100px":"0px"}));i((()=>({overflow:"hidden",height:ta.value?"auto":"0"})));const ia=l({font:{fontSize:14,color:"rgba(0, 0, 0, 0.10)"},zIndex:1,rotate:-22,gap:[150,150],offset:[]}),sa=a(!1),oa=()=>{sa.value=!sa.value},ra=B("image/user.png"),ca=B("image/ai-logo.png"),da=a(""),ua=a(),va=a(),pa=a([{content:"需要设置通用模型的配置"}]),ha=a([{speaker:"default",title:"Hi，我是AI助手",content:"对话基于通用模型的api，与网页本身无关。",loading:!1,isStart:!0,idx:0,parentId:-1}]),fa=a([{speaker:"default",title:"Hi，我是AI助手",content:"对话基于通用模型的api，与网页本身无关。",loading:!1,isStart:!0,idx:0,parentId:-1}]),ga=a(""),ya=function(){ma()},ma=()=>{let e=a(localStorage.getItem("name"));e.value?ga.value=V()+"-"+e.value:ga.value=V()+"-customer",sessionStorage.setItem("itemUuid",ga.value)},xa=e=>{e.preventDefault()},wa=e=>{e.preventDefault(),Oa(1)},_a=a(0),ka=(a(),a()),ba=a([]),Ia=a(!1),Sa=a(!1);a(!0);const Ca=function(e){try{if(""===e.input){fa.value[fa.value.length-1].content=Re,e.input=Re}let a={data:{dialogue_create_time:"",dialogue_id:Qe.value+1,topic_id:1}};return Qe.value+=1,a}catch(a){return null}},Oa=async function(e){if(Sa.value);else{if(Sa.value=!0,0==_a.value){await ya(),ba.value=[];let e={speaker:"none",content:"root-null",loading:!1,idx:0,parentId:-1,children:[],currentPage:-1,create_time:"1",session_id:null};ba.value.push(e),_a.value=1}else ga.value=fa.value[fa.value.length-1].session_id;let t;1==e?(t=JSON.parse(JSON.stringify(da.value)),da.value=""):t=JSON.parse(JSON.stringify(fa.value[fa.value.length-1].content));let n,l=fa.value.length-1;if(0==_a.value){ga.value;try{oa();let e={input:t,parent_id:0,topic_id:1,session_id:ga.value,content_type:1};n=Ca(e)}catch(a){return}}else{let e={input:t,parent_id:fa.value[fa.value.length-1].idx,topic_id:_a.value,session_id:ga.value,content_type:1};n=Ca(e)}let i={speaker:"user",content:t,loading:!1,idx:n.data.dialogue_id,isEdit:!1,session_id:ga.value,parentId:fa.value[fa.value.length-1].idx,children:[],currentPage:-1};Ta(i),await Pa(t,l,1)}},Ta=function(e){const a=ba.value.find((a=>a.idx===e.parentId));a.children.push(e.idx);const t=a.children.indexOf(e.idx);-1!==t&&(a.currentPage=t+1),e.nodeInfo={pPage:a.currentPage,length:a.children.length},ba.value.push(e),fa.value.push(e)},Na=a(),Pa=async function(e,a,t){let n=[];""!=Ve.value&&n.push({role:"system",content:Ve.value}),fa.value.forEach(((e,a)=>{"none"==e.speaker||""==e.content||"default"==e.speaker||n.push({role:e.speaker,content:e.content})}));let l={speaker:"assistant",content:"",loading:!0,idx:-1,isEdit:!1,session_id:ga.value,parentId:fa.value[fa.value.length-1].idx,children:[],currentPage:-1,htmlContent:""};2!=t&&4!=t||(l.parentId=fa.value[fa.value.length-1].idx),await Ta(l),Na.value=new AbortController;let i=setTimeout((()=>{Na.value&&Aa(1)}),2e4);try{const e=await La(n,a);clearTimeout(i),e&&await Ha(e,l)}catch(s){Ea(s,l)}},La=async function(e,a){const{signal:t}=Na.value;try{let a=JSON.stringify({model:$e.value,messages:e,stream:!0});const n={"Content-Type":"application/json",Accept:"application/json"};Ke.value&&(n[Ke.value.name]=Ke.value.value);const l=await fetch("".concat(We.value),{method:"POST",signal:t,headers:n,body:a});if(!l.ok)throw Sa.value=!1,new Error("HTTP error! status: ".concat(l.status));return l}catch(n){throw n}},Ha=async function(e,a){var t;const n=null==(t=e.body)?void 0:t.getReader();let l="",i=!1,s=fa.value[fa.value.length-1];for(0==_a.value&&oa();!i;){const{value:e,done:a}=await n.read();if(e){l+=(new TextDecoder).decode(e);const a=l.split("\n");l=a.pop();for(const e of a)if(""===e.trim());else try{try{const a=e.replace("data: ",""),t=JSON.parse(a);if(t.choices&&t.choices.length>0){const e=t.choices[0].delta.content;e&&(s.content+=e,s.htmlContent=Ba(s.content,s))}if(t.choices&&"stop"===t.choices[0].finish_reason){i=!0;break}}catch(p){}}catch(p){}}a&&(i=!0)}let o={input:s.content,parent_id:a.parentId,topic_id:_a.value,session_id:ga.value,content_type:2},r=await Ca(o);s.idx=r.data.dialogue_id;const c=fa.value.find((e=>e.idx===a.parentId)),d=ba.value.find((e=>e.idx===a.parentId)),u=c.children.findIndex((e=>-1===e)),v=d.children.findIndex((e=>-1===e));c.children[u]=r.data.dialogue_id,d.children[v]=r.data.dialogue_id,Sa.value=!1,s=fa.value[fa.value.length-1],s.loading=!1,localStorage.removeItem("conv"),localStorage.setItem("conv",JSON.stringify(fa.value))},Ja=a(0),Ea=async function(e,a){e.name;let t=fa.value[fa.value.length-1];Sa.value=!1;let n={input:t.content,parent_id:a.parentId,topic_id:_a.value,session_id:ga.value,content_type:2};0!=Ja.value&&ka.value&&(n.topic_id=ka.value.topic_id);let l=await Ca(n);t.idx=l.data.dialogue_id;const i=fa.value.find((e=>e.idx===a.parentId)),s=ba.value.find((e=>e.idx===a.parentId)),o=i.children.findIndex((e=>-1===e)),r=s.children.findIndex((e=>-1===e));i.children[o]=l.data.dialogue_id,s.children[r]=l.data.dialogue_id,ka.value=null,Ja.value=0},Aa=function(e){null!=Na.value?(2==e||(Sa.value=!1),3==e?Ja.value=1:4==e&&(Ja.value=2),fa.value[fa.value.length-1].loading=!1,Na.value.abort(),Na.value=null):Sa.value=!1},ja=()=>{if(window.innerWidth<=1440){if(ua.value){const e=ua.value;e.style.height="20px";const a=e.scrollHeight;if(28>=a||0===da.value.length)return void za();e.style.removeProperty("overflow-y"),e.style.height=a+"px";const t=va.value,n=e.offsetHeight;t.style.height=n+"px"}ia.font.fontSize=12,ia.gap=[50,50]}else if(ua.value){const e=ua.value;e.style.height="32px";const a=e.scrollHeight;if(32>=a||0===da.value.length)return void za();e.style.removeProperty("overflow-y"),e.style.height=a+"px";const t=va.value,n=e.offsetHeight;t.style.height=n+"px"}},za=()=>{if(window.innerWidth<1440){if(ua.value){const e=ua.value;e.style.height="20px",e.style.overflowY="hidden";va.value.style.height="32px"}}else if(ua.value){const e=ua.value;e.style.height="32px",e.style.overflowY="hidden";va.value.style.height="40px"}},Ba=function(e,a){if(""==e)return"<p></p>";var t=U.parse(e);return t=t.trim()},{proxy:Ra}=s(),Ua=function(e){var a=e.getElementsByTagName("code")[0].innerHTML,t=decodeURIComponent(a);Ra.$copyText(t).then((a=>{const t=e.innerHTML;e.innerHTML='<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">\n                    <polyline points="20 6 9 17 4 12"></polyline>\n                </svg>\n                <span>Copied!</span>',setTimeout((()=>{e.innerHTML=t}),1e3)}),(e=>{}))},Ma=a(!0),Da=a(null),Wa=async()=>{var e;const a=null==(e=Da.value)?void 0:e.$el.querySelector(".el-scrollbar__wrap");a.scrollTo({top:a.scrollHeight,behavior:"smooth"})},$a=()=>{var e;const a=null==(e=Da.value)?void 0:e.$el.querySelector(".el-scrollbar__wrap");if(!a)return;const t=a.scrollHeight-(a.scrollTop+a.clientHeight);Ma.value=t<=10},Ka=e=>{Ra.$copyText(e).then((function(e){R({message:"复制成功",type:"success"})}),(function(e){R({message:"复制失败",type:"warning"})}))},Va=a(!1),qa=a(),Fa=a(),Qa=a(null),Xa=a(),Ya=async function(e){let a={speaker:e.speaker,content:e.content,loading:!1,idx:e.idx,isEdit:!1,session_id:e.session_id,parentId:e.parentId,create_time:e.create_time,children:e.children,currentPage:-1};const t=ba.value.find((e=>e.idx===a.parentId));t.currentPage=e.nodeInfo.pPage;const n=fa.value.findIndex((e=>e.idx===t.idx));-1!==n&&(fa.value.splice(n+1),await Ta(a),fa.value=[...fa.value])},Ga=a(window.innerWidth),Za=()=>{Ga.value=window.innerWidth},et=i((()=>Ga.value>1920?"large-textarea":Ga.value>1440&&Ga.value<=1920?"medium-textarea":"small-textarea")),at=a(0),tt=function(e){Sa.value&&Aa(1)},nt=function(){localStorage.removeItem("conv"),fa.value=JSON.parse(JSON.stringify(ha.value))},lt=function(){const e=fa.value.map((e=>"Speaker: ".concat(e.speaker,"\nContent:\n").concat(e.content,"\n"))).join("\n---\n"),a=new Blob([e],{type:"text/plain"}),t=URL.createObjectURL(a),n=document.createElement("a");n.href=t,n.download="QA.txt",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)};return o((async()=>{var e;let a=localStorage.getItem("conv");a&&(_a.value=1,fa.value=JSON.parse(a),ba.value=JSON.parse(JSON.stringify(fa.value))),window.copy=Ua,function(){if(De.value.topK)Ze.value=De.value.topK,ea.value=De.value.topP,aa.value=De.value.temperature;else{Ze.value=JSON.parse(JSON.stringify(Xe.value)),ea.value=JSON.parse(JSON.stringify(Ye.value)),aa.value=JSON.parse(JSON.stringify(Ge.value));let e={topK:Ze.value,topP:ea.value,temperature:aa.value};Fe(e)}}(),await function(){const e={code(e,a,t){var n=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return a&&"html"==a&&(n=encodeURIComponent(e)),a&&(n=q.highlightAuto(e).value),""===a.trim()&&(a="bash"),'<div class="bg-white mb-4 rounded-md">\n      <div class="code_header flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans">\n        <span>'.concat(a||"",'</span>\n        <button onclick="copy(this)" class="copy-btn">\n          <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">\n            <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>\n          </svg>\n          <span>Copy code</span>\n          <code style="display:none">').concat(encodeURIComponent(e),'</code>\n        </button>\n      </div>\n\n      <div class="p-4 overflow-y-auto">\n        <code class="whitespace-pre hljs language-').concat(a,'">').concat(n,"</code>\n      </div>\n    </div>")},paragraph:e=>'<p style="white-space:pre-wrap;">'.concat(e,"</p >")};U.use({renderer:e})}(),ua.value&&ja();const t=null==(e=Da.value)?void 0:e.$el.querySelector(".el-scrollbar__wrap");t&&t.addEventListener("scroll",$a),window.addEventListener("resize",Za),window.addEventListener("beforeunload",tt)})),r((()=>{var e;const a=null==(e=Da.value)?void 0:e.$el.querySelector(".el-scrollbar__wrap");a&&a.removeEventListener("scroll",$a),window.removeEventListener("resize",Za),window.removeEventListener("beforeunload",tt)})),n(fa,((e,a)=>{Va.value||(async()=>{var e;const a=null==(e=Da.value)?void 0:e.$el.querySelector(".el-scrollbar__wrap");Ma.value&&(Ia.value?(await P(),a.scrollTo({top:a.scrollHeight,behavior:"smooth"})):(await P(),a.scrollTo({top:a.scrollHeight}))),Ia.value=!1})(),async function(){let e=fa.value.length;fa.value[e-1].content==Re?at.value=1:"user"===fa.value[e-1].speaker?at.value=2:(at.value=0,await P(),ua.value&&await ja())}()}),{deep:!0}),n((()=>da.value),((e,a)=>{e!==a&&ja()})),n((()=>qa.value),((e,a)=>{e!==a&&(async()=>{})()})),n([Ze,ea,aa],(([e,a,t])=>{Fe({topK:e,topP:a,temperature:t})})),(e,a)=>{const t=L,n=M,l=D,i=H,s=W,o=$,r=K;return c(),d("div",Q,[u("div",X,[v(t,{class:"conf-btn-1",onClick:F},{default:p((()=>[h("设置")])),_:1}),v(t,{class:"conf-btn-2",onClick:nt},{default:p((()=>[h("清空")])),_:1}),v(t,{class:"conf-btn-3",onClick:lt},{default:p((()=>[h("下载")])),_:1}),u("div",Y,[v(f(E),{ref_key:"apiSetRef",ref:j,type:2,isOpen:f(A),onCloseCard:Ue},null,8,["isOpen"])]),u("div",G,[u("div",{class:g(["dropdown-container",{expanded:f(ta)}]),style:y(f(la)),ref_key:"confPlace",ref:na},[u("div",{class:"dd-header",onClick:F},[u("div",null,m(f(qe)),1)])],6)]),v(r,{ref_key:"scrollArea",ref:Da,class:"scroll-area",style:{width:"100%",height:"calc(100% - 150px)","margin-top":"30px"}},{default:p((()=>[v(o,{content:["AI生成","生成内容仅供参考"],gap:f(ia).gap,"z-index":f(ia).zIndex,font:f(ia).font},{default:p((()=>[f(fa).length>0?(c(),d("div",{key:0,class:"all-content",ref_key:"allOutDiv",ref:Xa},[(c(!0),d(x,null,w(f(fa),((e,o)=>(c(),d(x,{key:o},["user"==e.speaker?(c(),d("div",Z,[u("div",ee,[u("div",ae,[e.isEdit?(c(),d("div",le,[u("div",{class:"c2",ref_for:!0,ref_key:"editRefOut",ref:Qa},[v(n,{ref_for:!0,ref_key:"editRef",ref:Fa,modelValue:f(qa),"onUpdate:modelValue":a[0]||(a[0]=e=>_(qa)?qa.value=e:null),autosize:"",type:"textarea",class:g(["edit-text",f(et)])},null,8,["modelValue","class"])],512),u("div",ie,[u("div",se,[0!=f(qa).length?(c(),k(t,{key:0,link:"",class:"btn-tooltip",onClick:a=>async function(e,a){e.isEdit=!1,Va.value=!1,Sa.value=!0,await ya();let t={input:qa.value,parent_id:e.parentId,topic_id:_a.value,session_id:ga.value,content_type:1},n=await Ca(t),l={session_id:e.session_id,new_session_id:ga.value},i=JSON.parse(JSON.stringify(e));i.children=[],i.content=qa.value,i.idx=n.data.dialogue_id,i.nodeInfo.pPage+=1,i.nodeInfo.length+=1,i.currentPage=i.nodeInfo.pPage,i.create_time=n.data.dialogue_create_time;try{await Ya(i),await forkData(l,i.content,1)}catch(s){}}(e)},{default:p((()=>[oe])),_:2},1032,["onClick"])):b("",!0),v(t,{link:"",class:"btn-tooltip",onClick:a=>(e.isEdit=!1,void(Va.value=!1)),style:{"margin-left":"4px"}},{default:p((()=>[re])),_:2},1032,["onClick"])])])])):(c(),d("div",te,[u("div",ne,m(e.content),1)])),u("div",ce,[v(l,{src:f(ra),class:"hm-img"},null,8,["src"])])])])])):b("",!0),"assistant"==e.speaker||"default"==e.speaker?(c(),d("div",de,[u("div",{class:g(["ai-content",{"last-item-ai":o==f(fa).length-1}])},[u("div",ue,[u("div",ve,[v(l,{src:f(ca),class:"ai-img"},null,8,["src"])]),u("div",pe,[u("div",{class:g(["ai-c2",{"warn-outer":e.content==Re}])},["default"==e.speaker?(c(),d("div",he,m(e.title),1)):b("",!0),e.content==Re?(c(),d("div",fe,ge)):b("",!0),u("div",{class:g([{"result-streaming":f(Sa)&&f(fa).length-1==o,"warn-content":e.content==Re},"c2"]),innerHTML:e.htmlContent},null,10,ye),e.isStart?(c(),d("div",me,[(c(!0),d(x,null,w(f(pa),((e,a)=>(c(),d("div",{key:a,class:"prompt-style"},[v(i,{class:"right-icon"},{default:p((()=>[v(f(I))])),_:1}),u("div",null,m(e.content),1)])))),128))])):b("",!0)],2),u("div",xe,[e.loading||e.title?b("",!0):(c(),d("div",we,[u("div",_e,[v(s,{class:"box-item",effect:"dark",content:"复制markdown",placement:"bottom"},{default:p((()=>[v(t,{link:"",onClick:a=>function(e){let a=e.content;Ka(a)}(e),class:"btn-tooltip",circle:""},{default:p((()=>[ke])),_:2},1032,["onClick"])])),_:2},1024)])]))])])])],2)])):b("",!0)],64)))),128)),be],512)):b("",!0)])),_:1},8,["gap","z-index","font"])])),_:1},512),f(Ma)||f(Sa)?b("",!0):(c(),d("div",{key:0,class:"stable-position",onClick:Wa},[v(t,{link:"",class:"btn-tooltip"},{default:p((()=>[Ie])),_:1})])),u("div",Se,[Ce,u("div",Oe,[0==f(at)?(c(),d("div",Te,[S(u("textarea",{ref_key:"inputChat",ref:ua,"onUpdate:modelValue":a[1]||(a[1]=e=>_(da)?da.value=e:null),onKeydown:O(xa,["enter"]),onKeyup:O(wa,["enter"])},null,544),[[C,f(da)]]),u("div",{ref_key:"inputBtn",ref:va,class:"btn-outer"},[!f(Sa)&&f(da).length>0?(c(),d("div",{key:0,onClick:a[2]||(a[2]=e=>Oa(1)),class:"click-btn"},Ne)):b("",!0),f(Sa)||0!=f(da).length?b("",!0):(c(),d("div",{key:1,onClick:a[3]||(a[3]=e=>{R({message:"输入不能为空，请调整输入！",type:"warning",offset:5,appendTo:"#inputArea"})}),class:"click-btn not-allow-send"},Pe)),f(Sa)?(c(),d("div",{key:2,onClick:a[4]||(a[4]=e=>async function(){Aa(1)}()),class:"click-btn"},Le)):b("",!0),He],512)])):b("",!0),1==f(at)?(c(),d("div",Je,[v(t,{class:"resend-btn",onClick:a[5]||(a[5]=e=>async function(e,a){Sa.value=!0,fa.value.pop(),await ya();let t={session_id:e.session_id,new_session_id:ga.value};const n=ba.value.find((a=>a.idx===e.parentId));try{await forkData(t,n.content,2)}catch(l){}}(f(fa)[f(fa).length-1]))},{default:p((()=>[Ee,Ae])),_:1})])):b("",!0),2==f(at)?(c(),d("div",je,[v(t,{class:"resend-btn",onClick:a[6]||(a[6]=e=>async function(e,a){e.isEdit=!1,Va.value=!1,at.value=0,Sa.value=!0,await ya();let t={input:e.content,parent_id:e.parentId,topic_id:_a.value,session_id:ga.value,content_type:1},n=await Ca(t),l={session_id:e.session_id,new_session_id:ga.value},i=JSON.parse(JSON.stringify(e));i.children=[],i.content=e.content,i.idx=n.data.dialogue_id,i.nodeInfo.pPage+=1,i.nodeInfo.length+=1,i.currentPage=i.nodeInfo.pPage,i.create_time=n.data.dialogue_create_time;try{await Ya(i),await forkData(l,i.content,1)}catch(s){}}(f(fa)[f(fa).length-1]))},{default:p((()=>[ze,Be])),_:1})])):b("",!0)])])])])}}}),[["__scopeId","data-v-d7ff820b"]]);export{Ue as default};
