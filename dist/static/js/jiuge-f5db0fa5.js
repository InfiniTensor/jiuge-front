import{g as e,u as t,m as n,H as a}from"./index-abc54105.js";import{d as l,r as o,a as i,s as r,w as s,c as u,g as c,o as v,b as p,e as d,f as h,n as g}from"./index-e720a51b.js";const w={class:"aichat-main"},f=l({__name:"jiuge",emits:["update-data"],setup(l,{emit:f}){o(!0),i([{icon:e("image/setting.png"),text:"设置",showPopover:!1,bigicon:!1,smallicon:!1},{icon:e("image/clean.png"),text:"清空",showPopover:!1,bigicon:!1,smallicon:!1},{icon:e("image/download.png"),text:"下载",showPopover:!1,bigicon:!1,smallicon:!1}]),o(!1),o();const m=t(),{llmParam:x,jiugeAuthHeader:y,jiugeApiBaseUrl:b}=r(m);s(b,(e=>{}));const S=function(e){m.setLlmParams(e)},H=o(0);i({40:{style:{color:"#1989FA"},label:"80(推荐)"}}),i({80:{style:{color:"#1989FA"},label:"0.8(推荐)"}}),i({40:{style:{color:"#1989FA"},label:"0.8(推荐)"}});const I=o(40),L=o(80),P=o(40),_=o(40),k=o(80),j=o(40),N=function(){if(x.value.topK)_.value=x.value.topK,k.value=x.value.topP,j.value=x.value.temperature;else{_.value=JSON.parse(JSON.stringify(I.value)),k.value=JSON.parse(JSON.stringify(L.value)),j.value=JSON.parse(JSON.stringify(P.value));let e={topK:_.value,topP:k.value,temperature:j.value};S(e)}},O=o(!1);o(),u((()=>window.innerWidth<=1440?{width:O.value?"260px":"130px",height:O.value?"168px":"32px",marginLeft:(O.value,"0px")}:window.innerWidth>1440&&window.innerWidth<=1920?{width:O.value?"320px":"160px",height:O.value?"168px":"36px",marginLeft:(O.value,"0px")}:{width:O.value?"400px":"200px",height:O.value?"168px":"42px",marginLeft:(O.value,"0px")})),u((()=>({overflow:"hidden",height:O.value?"auto":"0"}))),o("九格大模型");const T=i({font:{fontSize:14,color:"rgba(0, 0, 0, 0.10)"},zIndex:1,rotate:-22,gap:[150,150],offset:[]});o(!1),e("image/user.png"),e("image/qiyuan-logo.png");const J=o(""),C=o(),A=o();o([{content:"我可以跟你进行多轮对话与互动"},{content:"我可以依据提问给出信息并进一步解读"},{content:"我可以持续学习各行各业的高质量知识"}]),o([{speaker:"system",title:"Hi，我是启元AI助手",content:"让我协助你了解知识、获得灵感、提升效率。",loading:!1,isStart:!0,idx:0,parentId:-1}]);const E=o([{speaker:"system",title:"Hi，我是启元AI助手",content:"让我协助你了解知识、获得灵感、提升效率。",loading:!1,isStart:!0,idx:0,parentId:-1}]);o("");const W=o(0);o(),o();const q=o([]),z=o(!1),M=async function(){const e=await $(0,q.value),t=await e.filter((e=>0===e.children.length)).reduce(((e,t)=>!e||new Date(parseInt(t.create_time))>new Date(parseInt(e.create_time))?t:e),null);if(!t)return[];const n=await B(t.idx,q.value);E.value=n},$=function(e,t){let n=[],a=[e];for(;a.length>0;){const e=a.pop(),l=t.find((t=>t.idx===e));l&&(n.push(l),a.push(...l.children))}return n},B=function(e,t){let n=[],a=t.find((t=>t.idx===e));for(;a&&(n.unshift(a),-1!==a.parentId);){const e=JSON.parse(JSON.stringify(t.find((e=>e.idx===a.parentId)))),n=e.children.indexOf(a.idx);-1!==n&&(e.currentPage=n+1),a.nodeInfo={pPage:e.currentPage,length:e.children.length},a=e}return n},K=o(!1);o(!0);const F=o(),U=o(0),D=()=>{if(window.innerWidth<=1440){if(C.value){const e=C.value;e.style.height="20px";const t=e.scrollHeight;if(28>=t||0===J.value.length)return void R();e.style.removeProperty("overflow-y"),e.style.height=t+"px";const n=A.value,a=e.offsetHeight;n.style.height=a+"px"}T.font.fontSize=12,T.gap=[50,50]}else if(C.value){const e=C.value;e.style.height="32px";const t=e.scrollHeight;if(32>=t||0===J.value.length)return void R();e.style.removeProperty("overflow-y"),e.style.height=t+"px";const n=A.value,a=e.offsetHeight;n.style.height=a+"px"}},R=()=>{if(window.innerWidth<1440){if(C.value){const e=C.value;e.style.height="20px",e.style.overflowY="hidden";A.value.style.height="32px"}}else if(C.value){const e=C.value;e.style.height="32px",e.style.overflowY="hidden";A.value.style.height="40px"}},{proxy:Y}=c(),V=function(e){var t=e.getElementsByTagName("code")[0].innerHTML,n=decodeURIComponent(t);Y.$copyText(n).then((t=>{const n=e.innerHTML;e.innerHTML='<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">\n                    <polyline points="20 6 9 17 4 12"></polyline>\n                </svg>\n                <span>Copied!</span>',setTimeout((()=>{e.innerHTML=n}),1e3)}),(e=>{}))},G=o(!0),Q=o(null),X=()=>{var e;const t=null==(e=Q.value)?void 0:e.$el.querySelector(".el-scrollbar__wrap");if(!t)return;const n=t.scrollHeight-(t.scrollTop+t.clientHeight);G.value=n<=10},Z=o(!1),ee=o();o(),o(null),o();const te=o(window.innerWidth),ne=()=>{te.value=window.innerWidth};u((()=>te.value>1920?"large-textarea":te.value>1440&&te.value<=1920?"medium-textarea":"small-textarea"));const ae=o(0),le=function(e){var t;K.value&&(t=1,null!=F.value?(2==t||(K.value=!1),3==t?U.value=1:4==t&&(U.value=2),E.value[E.value.length-1].loading=!1,F.value.abort(),F.value=null):K.value=!1)},oe=function(){!async function(){q.value=JSON.parse(localStorage.getItem("jiugeConv")),H.value=q.value.length,await M()}()};return v((async()=>{var e;localStorage.getItem("jiugeConv")&&(W.value=1,oe()),window.copy=V,N(),await function(){const e={code(e,t,n){var l=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return""===t.trim()&&(t="bash"),"vue"===t&&(t="javascript"),t&&(l=a.highlight(t,e).value),'<div class="bg-white mb-4 rounded-md">\n      <div class="code_header flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans">\n        <span>'.concat(t||"",'</span>\n        <button onclick="copy(this)" class="copy-btn">\n          <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">\n            <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>\n          </svg>\n          <span>Copy code</span>\n          <code style="display:none">').concat(encodeURIComponent(e),'</code>\n        </button>\n      </div>\n\n      <div class="p-4 overflow-y-auto">\n        <code class="whitespace-pre hljs language-').concat(t,'">').concat(l,"</code>\n      </div>\n    </div>")},paragraph:e=>'<p style="white-space:pre-wrap;">'.concat(e,"</p >")};n.use({renderer:e})}(),C.value&&D();const t=null==(e=Q.value)?void 0:e.$el.querySelector(".el-scrollbar__wrap");t&&t.addEventListener("scroll",X),window.addEventListener("resize",ne),window.addEventListener("beforeunload",le)})),p((()=>{var e;const t=null==(e=Q.value)?void 0:e.$el.querySelector(".el-scrollbar__wrap");t&&t.removeEventListener("scroll",X),window.removeEventListener("resize",ne),window.removeEventListener("beforeunload",le)})),s(E,((e,t)=>{Z.value||(async()=>{var e;const t=null==(e=Q.value)?void 0:e.$el.querySelector(".el-scrollbar__wrap");G.value&&(z.value?(await g(),t.scrollTo({top:t.scrollHeight,behavior:"smooth"})):(await g(),t.scrollTo({top:t.scrollHeight}))),z.value=!1})(),async function(){let e=E.value.length;"服务器返回出错，请重新生成！"==E.value[e-1].content?ae.value=1:"user"===E.value[e-1].speaker?ae.value=2:(ae.value=0,await g(),C.value&&await D())}()}),{deep:!0}),s((()=>J.value),((e,t)=>{e!==t&&D()})),s((()=>ee.value),((e,t)=>{e!==t&&(async()=>{})()})),s((()=>x.value),((e,t)=>{N()})),s([_,k,j],(([e,t,n])=>{S({topK:e,topP:t,temperature:n})})),(e,t)=>(d(),h("div",w))}});export{f as default};
